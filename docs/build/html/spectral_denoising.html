<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spectral_denoising package &mdash; Spectral denoising 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=8d563738"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="spectral_denoising" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Spectral denoising
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">spectral_denoising</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">spectral_denoising package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.chem_utils">spectral_denoising.chem_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.calculate_precursormz"><code class="docutils literal notranslate"><span class="pre">calculate_precursormz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.desalter"><code class="docutils literal notranslate"><span class="pre">desalter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.determine_adduct_charge"><code class="docutils literal notranslate"><span class="pre">determine_adduct_charge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.determine_parent_coefs"><code class="docutils literal notranslate"><span class="pre">determine_parent_coefs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.get_bond_similarity"><code class="docutils literal notranslate"><span class="pre">get_bond_similarity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.parse_adduct"><code class="docutils literal notranslate"><span class="pre">parse_adduct()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.parse_formula"><code class="docutils literal notranslate"><span class="pre">parse_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.replace_adduct_string"><code class="docutils literal notranslate"><span class="pre">replace_adduct_string()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.chem_utils.transpose_formula"><code class="docutils literal notranslate"><span class="pre">transpose_formula()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.constant">spectral_denoising.constant module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.denoising_search">spectral_denoising.denoising_search module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.denoising_search.denoising_search"><code class="docutils literal notranslate"><span class="pre">denoising_search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.denoising_search.denoising_search_batch"><code class="docutils literal notranslate"><span class="pre">denoising_search_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.file_io">spectral_denoising.file_io module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.file_io.check_pattern"><code class="docutils literal notranslate"><span class="pre">check_pattern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.file_io.read_df"><code class="docutils literal notranslate"><span class="pre">read_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.file_io.read_msp"><code class="docutils literal notranslate"><span class="pre">read_msp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.file_io.sanitize_df_cols"><code class="docutils literal notranslate"><span class="pre">sanitize_df_cols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.file_io.save_df"><code class="docutils literal notranslate"><span class="pre">save_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.file_io.write_to_msp"><code class="docutils literal notranslate"><span class="pre">write_to_msp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.identifier_utils">spectral_denoising.identifier_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.cas_to_smiles"><code class="docutils literal notranslate"><span class="pre">cas_to_smiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.create_classyfire_url"><code class="docutils literal notranslate"><span class="pre">create_classyfire_url()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.everything_to_formula"><code class="docutils literal notranslate"><span class="pre">everything_to_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.everything_to_image"><code class="docutils literal notranslate"><span class="pre">everything_to_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.everything_to_inchikey"><code class="docutils literal notranslate"><span class="pre">everything_to_inchikey()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.everything_to_mw"><code class="docutils literal notranslate"><span class="pre">everything_to_mw()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.everything_to_smiles"><code class="docutils literal notranslate"><span class="pre">everything_to_smiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.get_classyfire"><code class="docutils literal notranslate"><span class="pre">get_classyfire()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.inchikey_to_smiles"><code class="docutils literal notranslate"><span class="pre">inchikey_to_smiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.is_cas_number"><code class="docutils literal notranslate"><span class="pre">is_cas_number()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.is_formula"><code class="docutils literal notranslate"><span class="pre">is_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.is_inchikey"><code class="docutils literal notranslate"><span class="pre">is_inchikey()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.is_mol"><code class="docutils literal notranslate"><span class="pre">is_mol()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.is_smiles"><code class="docutils literal notranslate"><span class="pre">is_smiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.name_to_smiles"><code class="docutils literal notranslate"><span class="pre">name_to_smiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.identifier_utils.smiles_to_inchikey"><code class="docutils literal notranslate"><span class="pre">smiles_to_inchikey()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.noise">spectral_denoising.noise module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.noise.add_noise"><code class="docutils literal notranslate"><span class="pre">add_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.noise.generate_chemical_noise"><code class="docutils literal notranslate"><span class="pre">generate_chemical_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.noise.generate_noise"><code class="docutils literal notranslate"><span class="pre">generate_noise()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.search_utils">spectral_denoising.search_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.search_utils.num_search"><code class="docutils literal notranslate"><span class="pre">num_search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.search_utils.quick_search_sorted"><code class="docutils literal notranslate"><span class="pre">quick_search_sorted()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.search_utils.quick_search_values"><code class="docutils literal notranslate"><span class="pre">quick_search_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.search_utils.string_search"><code class="docutils literal notranslate"><span class="pre">string_search()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.seven_golden_rules">spectral_denoising.seven_golden_rules module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.seven_golden_rules.check_ratio"><code class="docutils literal notranslate"><span class="pre">check_ratio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.seven_golden_rules.check_senior"><code class="docutils literal notranslate"><span class="pre">check_senior()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.spectra_plotter">spectral_denoising.spectra_plotter module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectra_plotter.head_to_tail_plot"><code class="docutils literal notranslate"><span class="pre">head_to_tail_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectra_plotter.ms2_plot"><code class="docutils literal notranslate"><span class="pre">ms2_plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.spectral_denoising">spectral_denoising.spectral_denoising module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.check_candidates"><code class="docutils literal notranslate"><span class="pre">check_candidates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.dict_to_formula"><code class="docutils literal notranslate"><span class="pre">dict_to_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.dnl_denoising"><code class="docutils literal notranslate"><span class="pre">dnl_denoising()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.electronic_denoising"><code class="docutils literal notranslate"><span class="pre">electronic_denoising()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.formula_denoising"><code class="docutils literal notranslate"><span class="pre">formula_denoising()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.get_all_subformulas"><code class="docutils literal notranslate"><span class="pre">get_all_subformulas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.get_denoise_tag"><code class="docutils literal notranslate"><span class="pre">get_denoise_tag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.get_pmz_statistics"><code class="docutils literal notranslate"><span class="pre">get_pmz_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.has_benzene"><code class="docutils literal notranslate"><span class="pre">has_benzene()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.ms_reduce"><code class="docutils literal notranslate"><span class="pre">ms_reduce()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.prep_formula"><code class="docutils literal notranslate"><span class="pre">prep_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.spectral_denoising"><code class="docutils literal notranslate"><span class="pre">spectral_denoising()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.spectral_denoising_batch"><code class="docutils literal notranslate"><span class="pre">spectral_denoising_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_denoising.threshold_denoising"><code class="docutils literal notranslate"><span class="pre">threshold_denoising()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising.spectral_operations">spectral_denoising.spectral_operations module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.add_spectra"><code class="docutils literal notranslate"><span class="pre">add_spectra()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.arr_to_str"><code class="docutils literal notranslate"><span class="pre">arr_to_str()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.break_spectrum"><code class="docutils literal notranslate"><span class="pre">break_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.compare_spectra"><code class="docutils literal notranslate"><span class="pre">compare_spectra()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.entropy_similairty"><code class="docutils literal notranslate"><span class="pre">entropy_similairty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.normalize_spectrum"><code class="docutils literal notranslate"><span class="pre">normalize_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.pack_spectrum"><code class="docutils literal notranslate"><span class="pre">pack_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.remove_precursor"><code class="docutils literal notranslate"><span class="pre">remove_precursor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.remove_zero_ions"><code class="docutils literal notranslate"><span class="pre">remove_zero_ions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.sanitize_spectrum"><code class="docutils literal notranslate"><span class="pre">sanitize_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.search_ions"><code class="docutils literal notranslate"><span class="pre">search_ions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.slice_spectrum"><code class="docutils literal notranslate"><span class="pre">slice_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.sort_spectrum"><code class="docutils literal notranslate"><span class="pre">sort_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.spctrum_entropy"><code class="docutils literal notranslate"><span class="pre">spctrum_entropy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.standardize_spectrum"><code class="docutils literal notranslate"><span class="pre">standardize_spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.str_to_arr"><code class="docutils literal notranslate"><span class="pre">str_to_arr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral_denoising.spectral_operations.truncate_spectrum"><code class="docutils literal notranslate"><span class="pre">truncate_spectrum()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectral_denoising">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Spectral denoising</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">spectral_denoising</a></li>
      <li class="breadcrumb-item active">spectral_denoising package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/spectral_denoising.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spectral-denoising-package">
<h1>spectral_denoising package<a class="headerlink" href="#spectral-denoising-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-spectral_denoising.chem_utils">
<span id="spectral-denoising-chem-utils-module"></span><h2>spectral_denoising.chem_utils module<a class="headerlink" href="#module-spectral_denoising.chem_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.calculate_precursormz">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">calculate_precursormz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adduct_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.calculate_precursormz" title="Link to this definition"></a></dt>
<dd><p>Calculate the precursor m/z (mass-to-charge ratio) for a given molecule and adduct string.
Very robust function, handles a wide variety of adducts strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adduct_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The adduct string representing the ion type and charge state.</p></li>
<li><p><strong>mol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The molecular formula of the compound. Defaults to None.</p></li>
<li><p><strong>testing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, use a predefined molecule mass for testing purposes. Defaults to False.</p></li>
<li><p><strong>float</strong> – The calculated precursor m/z value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated precursor m/z value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>precursor_mz (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Warning" title="(in Python v3.12)"><strong>Warning</strong></a> – If an unrecognized adduct is encountered in the adduct string, it will be ignored and a warning will be printed.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses the <cite>Formula</cite> class to calculate the mass of the molecule and ions.</p></li>
<li><p>The <cite>replace_adduct_string</cite>, <cite>determine_parent_coefs</cite>, <cite>determine_adduct_charge</cite>, and <cite>parse_adduct</cite> functions are assumed to be defined elsewhere in the codebase.</p></li>
<li><p>The electron mass is considered in the calculation to adjust for the loss/gain of electrons.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.desalter">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">desalter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.desalter" title="Link to this definition"></a></dt>
<dd><p>Processes the input molecule to remove salts and return an uncharged SMILES string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>RDKit Mol</em>) – The input molecule, which can be a SMILES string or an RDKit Mol object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The uncharged SMILES string of the largest component of the input molecule.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>uncharged_smiles (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If the input is not a valid molecule, the function will attempt to convert it to a SMILES string.</p></li>
<li><p>If the input molecule contains multiple components, the largest component will be processed.</p></li>
<li><p>If the largest component has a formal charge of +1, acidic hydrogens will be removed.</p></li>
<li><p>If the input is NaN, the function will return np.NAN.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.determine_adduct_charge">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">determine_adduct_charge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adduct_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.determine_adduct_charge" title="Link to this definition"></a></dt>
<dd><p>Determine the charge of an adduct based on its string representation.
This function processes an adduct string to determine its charge. The adduct string
is first standardized using the <cite>replace_adduct_string</cite> function. The charge is then
determined based on the ending character(s) of the string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>adduct_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The string representation of the adduct.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The charge of the adduct. Returns a positive integer for positive charges,
a negative integer for negative charges, and NaN if the charge cannot be determined.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>charge (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a>)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If the adduct string ends with ‘+’, the function checks if the preceding character is a digit
and if the charge is enclosed in brackets. If so, it extracts the charge; otherwise, it assumes
a charge of +1.</p></li>
<li><p>If the adduct string ends with ‘-’, the function performs a similar check for negative charges.</p></li>
<li><p>If the adduct string does not end with ‘+’ or ‘-’, the function returns NaN and prints a message
indicating that the charge could not be determined.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.determine_parent_coefs">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">determine_parent_coefs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adduct_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.determine_parent_coefs" title="Link to this definition"></a></dt>
<dd><p>Determine the coefficient of of the adducts by ignoring the parent ion M.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>adduct_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The adduct string from which to determine the parent molecule coefficient.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The coefficient of the adduct (e.g. M+H, coef =1, M+2H+, coef = 2). If the adduct string does not match the expected pattern, the function prints an error message and returns numpy’s NaN.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>coefficient (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.get_bond_similarity">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">get_bond_similarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.get_bond_similarity" title="Link to this definition"></a></dt>
<dd><p>Calculate the bond similarity between two molecules.
Detailed algorithm can be found in the following paper: Spectral entropy outperforms MS/MS dot product similarity for small-molecule compound identification (Yuanyue Li et al., 2021)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol1</strong> – The first molecule, which can be in various formats (e.g., SMILES string, RDKit molecule object).</p></li>
<li><p><strong>mol2</strong> – The second molecule, which can be in various formats (e.g., SMILES string, RDKit molecule object).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary containing the following keys:</dt><dd><ul class="simple">
<li><p>”mol1_bond_number”: The number of bonds in the first molecule.</p></li>
<li><p>”mol2_bond_number”: The number of bonds in the second molecule.</p></li>
<li><p>”common_bond_number”: The number of common bonds between the two molecules.</p></li>
<li><p>”bond_difference”: The average bond difference between the two molecules.</p></li>
<li><p>”bond_similarity”: The bond similarity score between the two molecules, calculated as
(2 * common_bond_number) / (mol1_bond_number + mol2_bond_number).</p></li>
<li><p>”minimal_diff”: The minimal difference in bond numbers after removing common bonds.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.parse_adduct">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">parse_adduct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adduct_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.parse_adduct" title="Link to this definition"></a></dt>
<dd><p>Parses an adduct string into its components.
This function takes an adduct string and breaks it down into its constituent parts,
including the sign, count, and ion type. The adduct string is first processed to
replace certain patterns, and then a regular expression is used to capture the
different parts of the adduct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>adduct_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The adduct string to be parsed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of lists, where each sublist contains the sign (str), count (int), and ion type (str) of each part of the adduct.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.parse_formula">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">parse_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.parse_formula" title="Link to this definition"></a></dt>
<dd><p>Parses a chemical formula into its constituent elements and their quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>formula</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – A string representing the chemical formula (e.g., “H2O”, “C6H12O6”).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of lists, where each inner list contains an element and its quantity
(e.g., [[‘H’, 2], [‘O’, 1]] for “H2O”).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.replace_adduct_string">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">replace_adduct_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adduct_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.replace_adduct_string" title="Link to this definition"></a></dt>
<dd><p>Replaces specific adduct strings with their standardized or chemical formula equivalents.
This function takes an adduct string and replaces it with a standardized version or its
corresponding chemical formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>adduct_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The adduct string to be replaced.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The replaced adduct string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>adduct_string (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.chem_utils.transpose_formula">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.chem_utils.</span></span><span class="sig-name descname"><span class="pre">transpose_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.chem_utils.transpose_formula" title="Link to this definition"></a></dt>
<dd><p>Transpose a parsed formula in a nested list format from [[element, quantity], …] to [[element, …], [quantity, …]].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – A list of lists where each sublist represents a row of the matrix.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transposed version of the input list of lists, where rows are converted to columns and vice versa.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising.constant">
<span id="spectral-denoising-constant-module"></span><h2>spectral_denoising.constant module<a class="headerlink" href="#module-spectral_denoising.constant" title="Link to this heading"></a></h2>
<p>Just collection of contants widely used in chemistry. Reference: <a class="reference external" href="https://fiehnlab.ucdavis.edu/staff/kind/Metabolomics/MS-Adduct-Calculator/">https://fiehnlab.ucdavis.edu/staff/kind/Metabolomics/MS-Adduct-Calculator/</a></p>
</section>
<section id="module-spectral_denoising.denoising_search">
<span id="spectral-denoising-denoising-search-module"></span><h2>spectral_denoising.denoising_search module<a class="headerlink" href="#module-spectral_denoising.denoising_search" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.denoising_search.denoising_search">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.denoising_search.</span></span><span class="sig-name descname"><span class="pre">denoising_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_lib</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identitiy_search_mass_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_tolernace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'precursor_mz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'smiles'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adduct_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adduct'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msms_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'peaks'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.denoising_search.denoising_search" title="Link to this definition"></a></dt>
<dd><p>Perform a denoising search on mass spectrometry data.
In addition to traditional identity search, the quene msms will be denoised using molecular information of all candidates within predefined identitiy_search_mass_error range.
Then, entropy similarity scores are calculated for both the original and denoised spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>np.array</em>) – The mass spectrometry data (peaks) to be denoised.</p></li>
<li><p><strong>pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The precursor m/z value associated with the quene MS/MS spectra.</p></li>
<li><p><strong>reference_lib</strong> (<em>pandas.DataFrame</em>) – The reference library containing known spectra and associated metadata.</p></li>
<li><p><strong>identitiy_search_mass_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The mass error tolerance for the identity search. Default is 0.01.</p></li>
<li><p><strong>mass_tolernace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The mass tolerance for spectral denoising. Default is 0.005.</p></li>
<li><p><strong>pmz_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The column name for precursor m/z values in the reference library. Default is ‘precursor_mz’.</p></li>
<li><p><strong>smiles_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The column name for SMILES strings in the reference library. Default is ‘smiles’.</p></li>
<li><p><strong>adduct_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The column name for adduct information in the reference library. Default is ‘adduct’.</p></li>
<li><p><strong>msms_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The column name for MS/MS peaks in the reference library. Default is ‘peaks’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing all the candidate spectra, with entropy similarity scores calculated based on both denoised and raw spectra.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.denoising_search.denoising_search_batch">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.denoising_search.</span></span><span class="sig-name descname"><span class="pre">denoising_search_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quene_msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quene_pmz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_lib</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identitiy_search_mass_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_tolernace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'precursor_mz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'smiles'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adduct_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adduct'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msms_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'peaks'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.denoising_search.denoising_search_batch" title="Link to this definition"></a></dt>
<dd><p>Perform batch denoising search on given MS/MS data and precursor m/z values with parallel processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quene_msms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – List of MS/MS spectra to be denoised.</p></li>
<li><p><strong>quene_pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – List of precursor m/z values corresponding to the MS/MS spectra.</p></li>
<li><p><strong>reference_lib</strong> (<em>pandas.DataFrame</em>) – Reference library containing known spectra for comparison.</p></li>
<li><p><strong>identitiy_search_mass_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Mass error tolerance for identity search. Default is 0.01.</p></li>
<li><p><strong>mass_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum allowed tolerance for denoising. Default is 0.005.</p></li>
<li><p><strong>pmz_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Column name for precursor m/z in the reference library. Default is ‘precursor_mz’.</p></li>
<li><p><strong>smiles_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Column name for SMILES in the reference library. Default is ‘smiles’.</p></li>
<li><p><strong>adduct_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Column name for adducts in the reference library. Default is ‘adduct’.</p></li>
<li><p><strong>msms_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Column name for MS/MS peaks in the reference library. Default is ‘peaks’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the results of the denoising search. Each index in the result DataFrame corresponds to the denoising search result of the corresponding input MS/MS spectrum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising.file_io">
<span id="spectral-denoising-file-io-module"></span><h2>spectral_denoising.file_io module<a class="headerlink" href="#module-spectral_denoising.file_io" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.file_io.check_pattern">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.file_io.</span></span><span class="sig-name descname"><span class="pre">check_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.file_io.check_pattern" title="Link to this definition"></a></dt>
<dd><p>Helper function for read_df.
Regular expression to match pairs of floats in standard or scientific notation separated by a tab, with each pair on a new line</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – input string to check for the pattern</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the pattern is found, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.file_io.read_df">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.file_io.</span></span><span class="sig-name descname"><span class="pre">read_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.file_io.read_df" title="Link to this definition"></a></dt>
<dd><p>Pair function of write_df.
Reads a CSV file into a DataFrame, processes specific columns based on a pattern check,
and MS/MS in string format to 2-D numpy array (string is used to avoid storage issue in csv files).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The file path to the CSV file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed DataFrame with specific columns converted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.12)"><strong>FileNotFoundError</strong></a> – If the file at the specified path does not exist.</p></li>
<li><p><strong>pd.errors.EmptyDataError</strong> – If the CSV file is empty.</p></li>
<li><p><strong>pd.errors.ParserError</strong> – If the CSV file contains parsing errors.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function assumes that the first row of the CSV file contains the column headers.</p></li>
<li><p>The <cite>check_pattern</cite> function is used to determine which columns to process.</p></li>
<li><p>The <cite>so.str_to_arr</cite> function is used to convert the values in the selected columns.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.file_io.read_msp">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.file_io.</span></span><span class="sig-name descname"><span class="pre">read_msp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.file_io.read_msp" title="Link to this definition"></a></dt>
<dd><p>Reads the MSP files into the pandas dataframe, and sort/remove zero intensity ions in MS/MS spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – target path path for the MSP file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the MS/MS spectra information</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.file_io.sanitize_df_cols">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.file_io.</span></span><span class="sig-name descname"><span class="pre">sanitize_df_cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.file_io.sanitize_df_cols" title="Link to this definition"></a></dt>
<dd><p>Sanitize the column names of a DataFrame by removing the ‘reference’ prefix and replacing ‘msms’ with ‘peaks’. Mainly used for compatibility with the data files from previous versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – the dataframe to sanitize</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the dataframe with columns are sanitized for spectral denoising/denoising search</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>df (pandas.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.file_io.save_df">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.file_io.</span></span><span class="sig-name descname"><span class="pre">save_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.file_io.save_df" title="Link to this definition"></a></dt>
<dd><p>Pair function of save_df.</p>
<p>Save a DataFrame contaning MS/MS spectra to a CSV file, converting any columns containing 2D numpy arrays to string format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The DataFrame to be saved.</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The file path where the DataFrame should be saved. If the path does not end with ‘.csv’, it will be appended automatically.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function identifies columns in the DataFrame that contain 2D numpy arrays with a second dimension of size 2.</p></li>
<li><p>These identified columns are converted to string format before saving to the CSV file.</p></li>
<li><p>The function uses tqdm to display a progress bar while processing the rows of the DataFrame.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.file_io.write_to_msp">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.file_io.</span></span><span class="sig-name descname"><span class="pre">write_to_msp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msms_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'peaks'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.file_io.write_to_msp" title="Link to this definition"></a></dt>
<dd><p>Pair function of read_msp.
Exports a pandas DataFrame to an MSP file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – DataFrame containing spectrum information. Should have columns for ‘name’, ‘peaks’, and other metadata.</p></li>
<li><p><strong>file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Destination path for the MSP file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising.identifier_utils">
<span id="spectral-denoising-identifier-utils-module"></span><h2>spectral_denoising.identifier_utils module<a class="headerlink" href="#module-spectral_denoising.identifier_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.cas_to_smiles">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">cas_to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.cas_to_smiles" title="Link to this definition"></a></dt>
<dd><p>Convert a CAS (Chemical Abstracts Service) number to a SMILES (Simplified Molecular Input Line Entry System) string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The CAS number of the chemical compound.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The SMILES string of the chemical compound if found, otherwise NaN.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.create_classyfire_url">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">create_classyfire_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.create_classyfire_url" title="Link to this definition"></a></dt>
<dd><p>Generates a URL for ClassyFire or NPClassifier based on the provided SMILES string. Just a helper function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.everything_to_formula">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">everything_to_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.everything_to_formula" title="Link to this definition"></a></dt>
<dd><p>Converts various chemical input to a molecular formula.
This function takes an input which can be in different chemical formats
(e.g., SMILES, molecular formula) and converts it to a standardized
molecular formula. If the input is already a molecular formula, it is
returned as is. If the input is a SMILES string, it is first converted
to a molecular object and then to a molecular formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The chemical input which can be a SMILES string,</p></li>
<li><p><strong>formula</strong> (<em>molecular</em>)</p></li>
<li><p><strong>format.</strong> (<em>or other recognizable chemical</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The molecular formula of the input chemical. If the input is</dt><dd><p>invalid or cannot be converted, returns NaN.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>formula (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.everything_to_image">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">everything_to_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.everything_to_image" title="Link to this definition"></a></dt>
<dd><p>Converts a molecular representation to an image and saves it to the specified path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>RDKit Mol object</em>) – The molecular representation, which can be a SMILES string,
an RDKit Mol object, or any other format that can be converted
to a SMILES string.</p></li>
<li><p><strong>savepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The file path where the generated image will be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.everything_to_inchikey">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">everything_to_inchikey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.everything_to_inchikey" title="Link to this definition"></a></dt>
<dd><p>Converts various chemical identifiers to an InChIKey or its first block.
This function takes an input which can be an InChIKey, a molecule object, a SMILES string,
a CAS number, or a chemical name, and converts it to an InChIKey. If the input is already
an InChIKey, it can return either the full InChIKey or just the first block of it based
on the <cite>first_block</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>RDKit Mol</em>) – The chemical identifier to be converted. It can be an InChIKey, a molecule object, a SMILES string, a CAS number, or a chemical name.</p></li>
<li><p><strong>first_block</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, returns only the first block of the InChIKey. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The InChIKey or its first block if <cite>first_block</cite> is True. Returns NaN if the
input is invalid or cannot be converted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>inchikey (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.everything_to_mw">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">everything_to_mw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.everything_to_mw" title="Link to this definition"></a></dt>
<dd><p>Converts a given molecule representation to its molecular weight (MW).
This function first checks if the input is a valid molecule object. If not, it attempts to convert the input to a SMILES string and then to a molecule object. Finally, it calculates and returns the exact molecular weight of the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> – The input molecule representation. This can be a molecule object or another representation that can be converted to a SMILES string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The exact molecular weight of the molecule.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><strong>ValueError</strong></a> – If the input cannot be converted to a valid molecule object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.everything_to_smiles">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">everything_to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.everything_to_smiles" title="Link to this definition"></a></dt>
<dd><p>Convert various chemical identifier formats to a SMILES string.
This function takes an input which can be in different chemical identifier formats
(SMILES, Mol, InChIKey, CAS number, or chemical name) and converts it to a SMILES string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>RDKit Mol</em>) – The chemical identifier to be converted. It can be a SMILES string, an RDKit Mol object, an InChIKey, a CAS number, or a chemical name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding SMILES string if the conversion is successful. Returns NaN if the input is NaN.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>smiles (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.get_classyfire">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">get_classyfire</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.get_classyfire" title="Link to this definition"></a></dt>
<dd><p>Retrieves the ClassyFire classification for a given SMILES string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The SMILES string of the molecule to classify.</p></li>
<li><p><strong>if_np</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – A flag indicating whether the molecule is a natural product. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The JSON response from the ClassyFire API if the request is successful,</dt><dd><p>otherwise numpy.NAN.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.inchikey_to_smiles">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">inchikey_to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inchikey</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.inchikey_to_smiles" title="Link to this definition"></a></dt>
<dd><p>helper function, but uses pubchem database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inchikey</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The inchikey of the molecule to look up.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The fetched isomeric SMILES code.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.is_cas_number">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">is_cas_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.is_cas_number" title="Link to this definition"></a></dt>
<dd><p>Check if a given string is a valid CAS (Chemical Abstracts Service) number.
A CAS number is a unique numerical identifier assigned to every chemical substance
described in the open scientific literature. It is formatted as one or more digits,
followed by a hyphen, followed by two or more digits, followed by another hyphen,
and ending with a single digit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The string to be checked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the string is a valid CAS number, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.is_formula">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">is_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.is_formula" title="Link to this definition"></a></dt>
<dd><p>Check if a given string is a valid chemical formula.
A valid chemical formula starts with an uppercase letter, optionally followed by a lowercase letter
(for two-letter elements), and optionally followed by a number (for the count of atoms). This pattern
repeats throughout the string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The string to be checked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the string is a valid chemical formula, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.is_inchikey">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">is_inchikey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.is_inchikey" title="Link to this definition"></a></dt>
<dd><p>Check if a given string is a valid InChIKey using regex.
An InChIKey is a 27-character string divided into three blocks by hyphens:
- The first block contains 14 uppercase letters.
- The second block contains 10 uppercase letters.
- The third block contains a single uppercase letter or digit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The string to be checked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the string is a valid InChIKey, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.is_mol">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">is_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.is_mol" title="Link to this definition"></a></dt>
<dd><p>Check if the given object is an instance of Chem.rdchem.Mol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> – The object to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the object is an instance of Chem.rdchem.Mol, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.is_smiles">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">is_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.is_smiles" title="Link to this definition"></a></dt>
<dd><p>Check if a given string is a valid SMILES (Simplified Molecular Input Line Entry System) representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The SMILES string to be validated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the SMILES string is valid, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_smiles</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_smiles</span><span class="p">(</span><span class="s2">&quot;invalid_smiles&quot;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.name_to_smiles">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">name_to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.name_to_smiles" title="Link to this definition"></a></dt>
<dd><p>Convert a chemical name to its corresponding SMILES (Simplified Molecular Input Line Entry System) representation, with Pubchem as backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The chemical name to be converted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The SMILES representation of the chemical if found, otherwise numpy.nan.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.identifier_utils.smiles_to_inchikey">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.identifier_utils.</span></span><span class="sig-name descname"><span class="pre">smiles_to_inchikey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.identifier_utils.smiles_to_inchikey" title="Link to this definition"></a></dt>
<dd><p>helper function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – A SMILES string representing a molecule.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The InChIKey of the molecule, first block only.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>inchikey (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising.noise">
<span id="spectral-denoising-noise-module"></span><h2>spectral_denoising.noise module<a class="headerlink" href="#module-spectral_denoising.noise" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.noise.add_noise">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.noise.</span></span><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.noise.add_noise" title="Link to this definition"></a></dt>
<dd><p>Add noise to a mass spectrum and process the resulting spectrum.
This function takes a mass spectrum and a noise spectrum, standardizes the mass spectrum,
adds the noise to it, normalizes the resulting spectrum, and sorts it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>np.ndarray</em>) – The mass spectrum to which noise will be added.</p></li>
<li><p><strong>noise</strong> (<em>np.ndarray</em>) – The noise spectrum to be added to the mass spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed mass spectrum after adding noise, normalization, and sorting.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The noise spectrum is generated with intensity as ralatie measure (from 0-1)</p></li>
<li><p>Thus, the mass spectrum is standardized using the standardize_spectrum function.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.noise.generate_chemical_noise">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.noise.</span></span><span class="sig-name descname"><span class="pre">generate_chemical_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pmz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.noise.generate_chemical_noise" title="Link to this definition"></a></dt>
<dd><p>Generate chemical noise for a given mass-to-charge ratio (m/z) and other parameters.
The m/z of the chemical noise is taken from a database of all true possible mass values.
The detailes about this database can be found paper: LibGen: Generating High Quality Spectral Libraries of Natural Products for EAD-, UVPD-, and HCD-High Resolution Mass Spectrometers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The target mass-to-charge ratio (m/z) value.</p></li>
<li><p><strong>lamda</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The lambda parameter for the Poisson distribution used to generate intensities, which serves as both mean and standard deviation of the distribution.</p></li>
<li><p><strong>polarity</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The polarity of the adduct, either ‘+’ or ‘-‘.</p></li>
<li><p><strong>formula_db</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing a column ‘mass’ with possible mass values.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The number of noise peaks to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A synthetic spectrum with chemical noise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><strong>ValueError</strong></a> – If the polarity is not ‘+’ or ‘-‘.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.noise.generate_noise">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.noise.</span></span><span class="sig-name descname"><span class="pre">generate_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pmz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.noise.generate_noise" title="Link to this definition"></a></dt>
<dd><p>Generate synthetic electronic noise for spectral data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The upper bound for the mass range.</p></li>
<li><p><strong>lamda</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The lambda parameter for the Poisson distribution, which serves as both mean and standard deviation of the distribution.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The number of random noise ions to generate. Defaults to 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A synthetic spectrum with electronic noise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising.search_utils">
<span id="spectral-denoising-search-utils-module"></span><h2>spectral_denoising.search_utils module<a class="headerlink" href="#module-spectral_denoising.search_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.search_utils.num_search">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.search_utils.</span></span><span class="sig-name descname"><span class="pre">num_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.search_utils.num_search" title="Link to this definition"></a></dt>
<dd><p>Perform a numerical search on a specified column of a DataFrame based on given criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The DataFrame to search within.</p></li>
<li><p><strong>column_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The name of the column to perform the search on.</p></li>
<li><p><strong>number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The reference number for the search condition.</p></li>
<li><p><strong>direction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The direction of the comparison. Can be one of the following:
‘&gt;’, ‘&lt;’, ‘==’, ‘between’.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The step value for the ‘between’ direction. Default is None.</p></li>
<li><p><strong>inclusion</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to include the boundary values in the comparison. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing rows that match the search criteria.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><strong>ValueError</strong></a> – If an invalid direction is provided.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_search</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_search</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">inclusion</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.search_utils.quick_search_sorted">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.search_utils.</span></span><span class="sig-name descname"><span class="pre">quick_search_sorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.search_utils.quick_search_sorted" title="Link to this definition"></a></dt>
<dd><p>Perform a quick search on a sorted column of a DataFrame to find rows within a specified range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_raw</strong> (<em>pd.DataFrame</em>) – The input DataFrame containing the data to search.</p></li>
<li><p><strong>column_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The name of the column to search within.</p></li>
<li><p><strong>value_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The starting value of the range.</p></li>
<li><p><strong>value_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The ending value of the range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing the rows where the values in the specified column fall within the given range.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.search_utils.quick_search_values">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.search_utils.</span></span><span class="sig-name descname"><span class="pre">quick_search_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.search_utils.quick_search_values" title="Link to this definition"></a></dt>
<dd><p>Perform a quick search on a DataFrame to find rows where the values in a specified column fall within a given range. Basically sorting the data first
followed by quick_search_sorted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_raw</strong> (<em>pd.DataFrame</em>) – The raw DataFrame to search.</p></li>
<li><p><strong>column_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The name of the column to search within.</p></li>
<li><p><strong>value_start</strong> (<em>numeric</em>) – The starting value of the range.</p></li>
<li><p><strong>value_end</strong> (<em>numeric</em>) – The ending value of the range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing rows where the values in the specified column are within the range [value_start, value_end].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.search_utils.string_search">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.search_utils.</span></span><span class="sig-name descname"><span class="pre">string_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.search_utils.string_search" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spectral_denoising.seven_golden_rules">
<span id="spectral-denoising-seven-golden-rules-module"></span><h2>spectral_denoising.seven_golden_rules module<a class="headerlink" href="#module-spectral_denoising.seven_golden_rules" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.seven_golden_rules.check_ratio">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.seven_golden_rules.</span></span><span class="sig-name descname"><span class="pre">check_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.seven_golden_rules.check_ratio" title="Link to this definition"></a></dt>
<dd><p>Checks the composition of chemical formula using ratio checks in the “7 golden rules”
(‘Seven Golden Rules for heuristic filtering of molecular formulas obtained by accurate mass spectrometry’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>formula</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The chemical formula to be checked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the formula passes all checks, False otherwise.
np.NAN: If the formula is invalid due to non-alphanumeric characters at the end.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
<dl class="simple">
<dt>The function performs the following checks:</dt><dd><ul class="simple">
<li><p>Checks the number of hydrogen and carbon atoms based on the accurate mass.</p></li>
<li><p>Checks the number of nitrogen and oxygen atoms.</p></li>
<li><p>Ensures the it is not a pure carbon/nitrogen loss (except N2)</p></li>
<li><p>Checks the hydrogen to carbon ratio.</p></li>
<li><p>Checks the fluorine to carbon ratio.</p></li>
<li><p>Checks the chlorine to carbon ratio.</p></li>
<li><p>Checks the bromine to carbon ratio.</p></li>
<li><p>Checks the nitrogen to carbon ratio.</p></li>
<li><p>Checks the oxygen to carbon ratio.</p></li>
<li><p>Checks the phosphorus to carbon ratio.</p></li>
<li><p>Checks the sulfur to carbon ratio.</p></li>
<li><p>Checks the silicon to carbon ratio.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.seven_golden_rules.check_senior">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.seven_golden_rules.</span></span><span class="sig-name descname"><span class="pre">check_senior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.seven_golden_rules.check_senior" title="Link to this definition"></a></dt>
<dd><p>Check if a given chemical formula satisfies SENIOR rules. not used in spectral_denoising and denoising search since SENIOR rules presumes an intact molecule, while losses can
be formed in the fragmentation process.
This function evaluates a chemical formula to determine if it meets the following criteria:
1. The sum of the valences of all elements must be at least twice the maximum valence of any single element.
2. The sum of the valences of all elements must be at least twice the number of elements minus one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>formula</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – A string representing the chemical formula to be evaluated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the formula satisfies the valence rules, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising.spectra_plotter">
<span id="spectral-denoising-spectra-plotter-module"></span><h2>spectral_denoising.spectra_plotter module<a class="headerlink" href="#module-spectral_denoising.spectra_plotter" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectra_plotter.head_to_tail_plot">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectra_plotter.</span></span><span class="sig-name descname"><span class="pre">head_to_tail_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msms2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mz_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mz_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ms2_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">publication</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectra_plotter.head_to_tail_plot" title="Link to this definition"></a></dt>
<dd><p>Plots a head-to-tail comparison of two MS/MS spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms1</strong> (<em>np.array</em>) – First mass spectrum data in 2D np.array format. e,g. np.array([[mz1, intensity1], [mz2, intensity2], …]).</p></li>
<li><p><strong>msms2</strong> (<em>np.array</em>) – Second mass spectrum data. Same as msms1.</p></li>
<li><p><strong>pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Precursor m/z value for the first spectrum. Default is None. If given, precursors will be removed from both spectra and precursor will be shown as a grey</p></li>
<li><p><strong>plot.</strong> (<em>dashed line in the</em>)</p></li>
<li><p><strong>mz_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Start of the m/z range for plotting. Zoom in function. Default is None.</p></li>
<li><p><strong>mz_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – End of the m/z range for plotting. Zoom in function. Default is None.</p></li>
<li><p><strong>pmz2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Precursor m/z value for the second spectrum. Default is None. Just in case pmz1 and pmz2 are different.</p></li>
<li><p><strong>ms2_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Error tolerance for m/z values. Default is 0.02.</p></li>
<li><p><strong>color1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Color for the first spectrum’s peaks. Default is None.</p></li>
<li><p><strong>color2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Color for the second spectrum’s peaks. Default is None.</p></li>
<li><p><strong>savepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Path to save the plot image. Default is None.</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, displays the plot. Default is True. Turn it off if you want to save the plot without displaying it.</p></li>
<li><p><strong>publication</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, formats the plot for publication (size 3*2.5 inch for single column figure). Default is False.</p></li>
<li><p><strong>fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Font size for plot labels. Default is 12.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The plot object if show is True, otherwise None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectra_plotter.ms2_plot">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectra_plotter.</span></span><span class="sig-name descname"><span class="pre">ms2_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectra_plotter.ms2_plot" title="Link to this definition"></a></dt>
<dd><p>Plots a single MS/MS spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms_1</strong> (<em>numpy.ndarray</em>) – MS/MS (or MS1) spectrum in 2D np.array format. e,g. np.array([[mz1, intensity1], [mz2, intensity2], …]).</p></li>
<li><p><strong>pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Precursor m/z value. If provided, precursor will be removed from the spectrum. Default is None.</p></li>
<li><p><strong>lower</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Lower bound for m/z values to be plotted. Default is None.</p></li>
<li><p><strong>upper</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Upper bound for m/z values to be plotted. Default is None.</p></li>
<li><p><strong>savepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Path to save the plot image. If None, the plot will not be saved. Default is None.</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Color of the spectrum lines. Default is ‘blue’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The plot object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising.spectral_denoising">
<span id="spectral-denoising-spectral-denoising-module"></span><h2>spectral_denoising.spectral_denoising module<a class="headerlink" href="#module-spectral_denoising.spectral_denoising" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.check_candidates">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">check_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.check_candidates" title="Link to this definition"></a></dt>
<dd><p>Checks a list of candidates to see if any of them meet a certain ratio condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>candidates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – A list of candidate formulas to be checked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if at least one candidate meets the ratio condition, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.dict_to_formula">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">dict_to_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.dict_to_formula" title="Link to this definition"></a></dt>
<dd><p>Helper function, to get the chemical formula from a candidate list and element dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – A list where each index corresponds to an element in <cite>element_dict</cite> and the value at each index represents the count of that element.</p></li>
<li><p><strong>element_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – A list of element symbols where the index corresponds to the element’s position in the <cite>candidate</cite> list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string representing the chemical formula, where each element symbol is followed by its count if greater than 1.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.dnl_denoising">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">dnl_denoising</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.dnl_denoising" title="Link to this definition"></a></dt>
<dd><p>Perform Dynamic noise level estimation denoising on given msms spectra.
Details about the algorithm can be found in the paper: A Dynamic Noise Level Algorithm for Spectral Screening of Peptide MS/MS Spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msms</strong> (<em>numpy.ndarray</em>) – A 2D numpy array with shape (2, n) where n is the number of data points. For each instance, first item is pmz and second item is intensity.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array containing the denoised mass spectrometry data, sorted and packed.
If the input data has only two points and does not meet the criteria, returns NaN.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p>Notes:
- The function assumes that the input data is a numpy array with two columns.
- The function uses a linear regression model to predict the signal region.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.electronic_denoising">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">electronic_denoising</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.electronic_denoising" title="Link to this definition"></a></dt>
<dd><p>Perform electronic denoising on a given mass spectrometry (MS/MS) spectrum.
This function processes the input MS/MS spectrum by sorting the peaks based on their intensity,
and then iteratively selects and confirms peaks based on a specified intensity threshold.
The confirmed peaks are then packed and sorted before being returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msms</strong> (<em>numpy.ndarray</em>) – A 2D array where the first column represents the mass-to-charge ratio (m/z)
and the second column represents the intensity of the peaks.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sorted and packed spectrum of confirmed peaks as a 2D array, or NaN if no peaks are confirmed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.formula_denoising">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">formula_denoising</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adduct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.formula_denoising" title="Link to this definition"></a></dt>
<dd><p>Perform formula denoising on the given mass spectrometry data. The function first re-generate formula based on chemical rules, get the statistic of the precursor m/z, and then perform formula denoising.
The precursor region is not affected by the denoising process, only the frgamnet region is denoised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.array</em>) – The mass spectrometry data to be denoised.</p></li>
<li><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The SMILES string representing the molecular structure.</p></li>
<li><p><strong>adduct</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The adduct type used in the mass spectrometry.</p></li>
<li><p><strong>mass_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The mass tolerance for precursor m/z calculation. Default is 0.005.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised mass spectrometry data, or np.nan If the SMILES string or adduct is invalid, or all ions removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.get_all_subformulas">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">get_all_subformulas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.get_all_subformulas" title="Link to this definition"></a></dt>
<dd><p>Generate all possible subformulas and their corresponding masses from a given chemical formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>raw_formula</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The input chemical formula, which can be in SMILES format or a standard chemical formula.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>all_possible_candidate_formula (list of str): A list of all possible subformulas derived from the input formula.</p></li>
<li><p>all_possible_mass (numpy.ndarray): An array of masses corresponding to each subformula.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If the input formula is in SMILES format, it will be converted to a standard chemical formula.</p></li>
<li><p>The function uses the <cite>chemparse</cite> library to parse the chemical formula and <cite>itertools.product</cite> to generate all possible combinations of subformulas.</p></li>
<li><p>The resulting subformulas and their masses are sorted in ascending order of mass for enhancing search process.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.get_denoise_tag">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">get_denoise_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag_msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_possible_candidate_formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_possible_mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_benzene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_threshold</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.get_denoise_tag" title="Link to this definition"></a></dt>
<dd><p>Determine which ions in the fragment regions are chemically feasible ion.
This function calculates the mass loss for each fragment in the MS/MS data and
searches for candidate formulas within a specified mass threshold. If the
<cite>has_benzene</cite> flag is set, the precursor mass (<cite>pmz</cite>) is adjusted by adding the
mass of the N2O isotope to count for rare cases of forming N2/H2O adducts in the collision chamber.
The ions will be given a True only if it can be associated with at least 1 chemically feasible subformula of the molecular formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frag_msms</strong> (<em>numpy.array</em>) – Array of fragment MS/MS data, where each tuple contains the mass and intensity of a fragment.</p></li>
<li><p><strong>all_possible_candidate_formula</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – List of all possible candidate formulas.</p></li>
<li><p><strong>all_possible_mass</strong> (<em>numpy.ndarray</em>) – Sorted array of all possible masses.</p></li>
<li><p><strong>pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Precursor mass.</p></li>
<li><p><strong>has_benzene</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Flag indicating if benzene is present.</p></li>
<li><p><strong>mass_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Mass threshold for searching candidate formulas.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of denoise tags for each fragment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.get_pmz_statistics">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">get_pmz_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_pmz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_tolerance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.get_pmz_statistics" title="Link to this definition"></a></dt>
<dd><p>Use the real precursor m/z to estimate the mass deviation in a given spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.ndarray</em>) – A 2D array where the first row contains m/z values and the second row contains intensity values.</p></li>
<li><p><strong>c_pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The computed m/z value around which to search for the most intense peak.</p></li>
<li><p><strong>mass_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The mass tolerance within which to search for the most intense peak.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- r_pmz (float): The actual precursor m/z. If not found (precursor is fully fragmented), the computed m/z is returned.
- float: The deviation between computed and actual precursor m/z, scaled by 1.75 if it exceeds the initial mass tolerance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.has_benzene">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">has_benzene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.has_benzene" title="Link to this definition"></a></dt>
<dd><p>Check if the given molecule contains a benzene ring.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Union</em><em>[</em><em>Chem.Mol</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em>) – The molecule to check. It can be a RDKit molecule object
or a SMILES string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the molecule contains a benzene ring, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.ms_reduce">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">ms_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.ms_reduce" title="Link to this definition"></a></dt>
<dd><p>Reimplementation of MS-Reduce algorithm.
Details about this algorithm can be found at: MS-REDUCE: an ultrafast technique for reduction of big mass spectrometry data for high-throughput processing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.ndarray</em>) – A 2D numpy array with shape (2, n) where n is the number of data points. For each instance, first item is pmz and second item is intensity.</p></li>
<li><p><strong>reduce_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The percentage by which to reduce the number of peaks. Default is 90.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reduced MS/MS spectrum as a 2D numpy array, sorted and packed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.prep_formula">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">prep_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adduct</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.prep_formula" title="Link to this definition"></a></dt>
<dd><p>Prepares the molecular formula based on the given SMILES string and adduct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The SMILES representation of the molecule.</p></li>
<li><p><strong>adduct</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The adduct string representing the ionization state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated molecular formula, or NaN if the formula cannot be determined.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.spectral_denoising">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">spectral_denoising</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adduct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.spectral_denoising" title="Link to this definition"></a></dt>
<dd><p>Perform spectral denoising on the given mass spectrometry data. The function first performs electronic denoising, followed by formula denoising.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.array</em>) – The mass spectrometry data to be denoised.</p></li>
<li><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The SMILES representation of the molecule.</p></li>
<li><p><strong>adduct</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The adduct type.</p></li>
<li><p><strong>mass_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The mass tolerance for the denoising process. Default is 0.005.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised mass spectrometry data.Returns NaN if the input is invalid or if the denoising process fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function first checks if any of the inputs are of type np.nan, which is considered invalid.</p></li>
<li><p>It then performs electronic denoising on the msms data.</p></li>
<li><p>If electronic denoising resulted in empty spectrum (all ions removed), it will return np.nan.</p></li>
<li><p>If successful, it proceeds to formula denoising using the electronic denoised data, smiles, adduct, and mass_tolerance.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.spectral_denoising_batch">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">spectral_denoising_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms_quene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_quene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adduct_quene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.spectral_denoising_batch" title="Link to this definition"></a></dt>
<dd><p>Perform batch spectral denoising on multiple sets of MS/MS spectra, SMILES strings, and adducts. Uses multiprocessing to parallelize the denoising process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms_quene</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – A list of MS/MS spectra data.</p></li>
<li><p><strong>smiles_quene</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – A list of SMILES strings corresponding to the MS/MS spectra.</p></li>
<li><p><strong>adduct_quene</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – A list of adducts corresponding to the MS/MS spectra.</p></li>
<li><p><strong>mass_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The allowed deviation for the denoising process. Default is 0.005.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of denoised MS/MS from the spectral denoising process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The lengths of msms_quene, smiles_quene, and adduct_quene must be the same. If not, the function will print an error message and return an empty tuple.</p></li>
<li><p>The function uses multiprocessing to parallelize the denoising process, utilizing 6 processes.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_denoising.threshold_denoising">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_denoising.</span></span><span class="sig-name descname"><span class="pre">threshold_denoising</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_denoising.threshold_denoising" title="Link to this definition"></a></dt>
<dd><p>The most widely used and simple denoising algorithm, which discard all peaks below a predefined threshold.
This function filters out peaks in the mass spectrometry spectrum whose
intensity is below a specified threshold percentage of the maximum intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.ndarray</em>) – A 2D numpy array with shape (2, n) where n is the number of data points. For each instance, first item is pmz and second item is intensity.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The threshold percentage (0-100) of the maximum intensity below which peaks will be removed. Default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>denoised spectrum as a 2D numpy array, sorted and packed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising.spectral_operations">
<span id="spectral-denoising-spectral-operations-module"></span><h2>spectral_denoising.spectral_operations module<a class="headerlink" href="#module-spectral_denoising.spectral_operations" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.add_spectra">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">add_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msms2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.add_spectra" title="Link to this definition"></a></dt>
<dd><p>Add two spectra together.
This function takes two spectra (msms1 and msms2) and combines them. If one of the inputs is a float and the other
is not, it returns the non-float input. If both inputs are floats, it returns NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms1</strong> (<em>numpy.ndarray</em>) – The first spectrum.</p></li>
<li><p><strong>msms2</strong> (<em>numpy.ndarray</em>) – The second spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The combined spectrum if both inputs are not floats, one of the inputs if the other is a float, or NaN if both inputs are floats.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function is very naive mixing of 2 spectrum. If you wished to formulate the intensity, please do it before using this function.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.arr_to_str">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">arr_to_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.arr_to_str" title="Link to this definition"></a></dt>
<dd><p>helper function for read_df and save_df</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.break_spectrum">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">break_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectra</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.break_spectrum" title="Link to this definition"></a></dt>
<dd><p>Breaks down a given spectrum into its mass and intensity components. Not often used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spectra</strong> (<em>numpy.ndarray</em>) – The input spectrum data. If a np.nan is provided, it returns two empty lists.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A MS/MS spectrum formated in 2D array where the each item are formated as [pmz, intensity].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.compare_spectra">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">compare_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msms2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.compare_spectra" title="Link to this definition"></a></dt>
<dd><p>Compare two mass spectra and return the spectrum of the second input
that does not overlap with the first input. Juist a helper function, not actually in use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms1</strong> (<em>numpy.ndarray</em>) – The first mass spectrum to compare.</p></li>
<li><p><strong>msms2</strong> (<em>numpy.ndarray</em>) – The second mass spectrum to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A packed spectrum of mass and intensity values from <cite>msms2</cite></dt><dd><p>that do not overlap with <cite>msms1</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.entropy_similairty">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">entropy_similairty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msms2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ms2_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.entropy_similairty" title="Link to this definition"></a></dt>
<dd><p>Calculate the entropy similarity between two mass spectrometry spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms1</strong> (<em>numpy.ndarray</em>) – The first mass spectrometry spectrum. If a float is provided, NaN is returned.</p></li>
<li><p><strong>msms1</strong> – The second mass spectrometry spectrum. If a float is provided, NaN is returned.</p></li>
<li><p><strong>pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The precursor m/z value. If provided, precursors in both spectra will be removed.</p></li>
<li><p><strong>ms2_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The tolerance for matching peaks in the spectra. Default is 0.02.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The entropy similarity between the two spectra. Returns NaN if either input spectrum is invalid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.normalize_spectrum">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">normalize_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.normalize_spectrum" title="Link to this definition"></a></dt>
<dd><p>Normalize the intensity values of a given mass spectrum.
This function takes a mass spectrum (msms) as input, transposes it, and normalizes
the intensity values (second row) by dividing each intensity by the sum of all intensities.
The normalized spectrum is then transposed back to its original form and returned.
:param msms: A 2D numpy array where the first row contains mass-to-charge ratios (m/z) and the second row contains intensity values.
:type msms: numpy.ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A 2D numpy array with the same shape as the input, where the intensity values have been normalized.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.pack_spectrum">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">pack_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.pack_spectrum" title="Link to this definition"></a></dt>
<dd><p>Inverse of break_spectrum. Packs mass and intensity arrays into a single 2D array, which is standardized MS/MS spectrum data format in this project.
This function takes two arrays, <cite>mass</cite> and <cite>intensity</cite>, and combines them into a single 2D array where each row
corresponds to a pair of mass and intensity values. If either of the input arrays is empty, the function returns NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>numpy.ndarray</em>) – An array of mass values.</p></li>
<li><p><strong>intensity</strong> (<em>numpy.ndarray</em>) – An array of intensity values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array with mass and intensity pairs if both input arrays are non-empty, otherwise NaN.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.remove_precursor">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">remove_precursor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.remove_precursor" title="Link to this definition"></a></dt>
<dd><p>Removes the precursor ion from the given mass spectrometry/mass spectrometry (MS/MS) spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.ndarray</em>) – A 2D numpy array.</p></li>
<li><p><strong>pmz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The precursor m/z value. If not provided, function will try to guess from the spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The truncated MS/MS spectrum with the precursor ion removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.remove_zero_ions">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">remove_zero_ions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.remove_zero_ions" title="Link to this definition"></a></dt>
<dd><p>Remove zero intensity ions from a mass spectrometry dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msms</strong> (<em>numpy.ndarray</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – MS/MS spectrum in 2D numpy array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A filtered 2D numpy array with rows where the second column (ion intensities) is greater than zero, or np.nan if the input is an empty spectrum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.sanitize_spectrum">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">sanitize_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.sanitize_spectrum" title="Link to this definition"></a></dt>
<dd><p>Sanitize the given mass spectrum.
This function performs the following operations on the input mass spectrum:
1. If the input is a nan, it returns NaN.
2. Sorts the spectrum using the <cite>sort_spectrum</cite> function.
3. Removes zero intensity ions using the <cite>remove_zero_ions</cite> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msms</strong> (<em>numpy.ndarray</em>) – The mass spectrum to be sanitized.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sanitized mass spectrum. If the input is a nan, returns nan.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.search_ions">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">search_ions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.search_ions" title="Link to this definition"></a></dt>
<dd><p>Search for ions within a specified mass-to-charge ratio (m/z) range in a given mass spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.ndarray</em>) – The mass spectrum data.</p></li>
<li><p><strong>mz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The target mass-to-charge ratio to search for.</p></li>
<li><p><strong>span</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The range around the target m/z to search within. Default is 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the slice of MS/MS spectra in the given region.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.slice_spectrum">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">slice_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">break_mz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.slice_spectrum" title="Link to this definition"></a></dt>
<dd><p>Slices a mass spectrum into two parts based on a given m/z value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.ndarray</em>) – The mass spectrum data, where each row represents a peak with m/z and intensity values. If a empty spectrum is provided, the function returns NaN.</p></li>
<li><p><strong>break_mz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The break point where to slice the spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing two numpy.ndarrays:</dt><dd><ul class="simple">
<li><p>The first array contains all peaks with m/z values less than the break_mz.</p></li>
<li><p>The second array contains all peaks with m/z values greater than or equal to the break_mz.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.sort_spectrum">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">sort_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.sort_spectrum" title="Link to this definition"></a></dt>
<dd><p>Sorts the spectrum data based on m/z values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msms</strong> (<em>numpy.ndarray</em>) – A 2D numpy array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array with the same shape as the input, but sorted by the m/z values in ascending order.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.spctrum_entropy">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">spctrum_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.spctrum_entropy" title="Link to this definition"></a></dt>
<dd><p>Calculate the entropy of the givens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msms</strong> (<em>numpy.ndarray</em>) – A 2D array where the each item are formated as [pmz, intensity].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The entropy of the query MS/MS spectrum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.standardize_spectrum">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">standardize_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.standardize_spectrum" title="Link to this definition"></a></dt>
<dd><p>Standardizes the intensity values of a given mass spectrum so that the base peak will have intensity of 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ms</strong> (<em>numpy.ndarray</em>) – A 2D array where the first column represents mass values and the second column represents intensity values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array with the same mass values and standardized intensity values. The intensity values are normalized to the range [0, 1] and rounded to 4 decimal places.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.str_to_arr">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">str_to_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.str_to_arr" title="Link to this definition"></a></dt>
<dd><p>helper function for read_df and save_df</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectral_denoising.spectral_operations.truncate_spectrum">
<span class="sig-prename descclassname"><span class="pre">spectral_denoising.spectral_operations.</span></span><span class="sig-name descname"><span class="pre">truncate_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_mz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectral_denoising.spectral_operations.truncate_spectrum" title="Link to this definition"></a></dt>
<dd><p>Truncate the given mass spectrum to only include peaks with m/z values less than or equal to max_mz.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msms</strong> (<em>numpy.ndarray</em>) – The mass spectrum to be truncated. If it is an empty spectrum (np.nan), will also return np.nan.</p></li>
<li><p><strong>max_mz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The maximum m/z value to retain in the truncated spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The truncated mass spectrum with m/z values less than or equal to max_mz.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectral_denoising">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-spectral_denoising" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="spectral_denoising" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Fanzhou Kong.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>